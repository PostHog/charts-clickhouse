# Tests charts/posthog/templates/_postgresql.tpl
suite: _postgresql.tpl template
templates:
  - templates/test-templates.yaml

tests:
  - it: should render with defaults
    set:
      testTemplates.postgresqlEnvTest: true
    asserts:
      - hasDocuments:
          count: 1
      - matchSnapshot:
          path: data

  - it: should render with custom values
    set:
      testTemplates.postgresqlEnvTest: true
      postgresql.nameOverride: customName
      postgresql.postgresqlDatabase: customDb
      postgresql.postgresqlUsername: customUser
      postgresql.postgresqlPassword: customPassword
    asserts:
      - matchSnapshot:
          path: data

  - it: should render with existing secret
    set:
      testTemplates.postgresqlEnvTest: true
      postgresql.existingSecret: someExistingSecret
    asserts:
      - matchSnapshot:
          path: data
